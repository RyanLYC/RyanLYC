## CSRF
CSRF，即 Cross Site Request Forgery，中译是跨站请求伪造，是一种劫持受信任用户向服务器发送非预期请求的攻击方式。

通常情况下，CSRF 攻击是攻击者借助受害者的 Cookie 骗取服务器的信任，可以在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击服务器，从而在并未授权的情况下执行在权限保护之下的操作。

## CSRF防御的常规思路

### 验证HTTP Referer字段
​ 众所周知，在HTTP头中有个字段的名字叫Referer，它记录了该HTTP请求的来源地址。在通常情况下，访问一个安全受限页面的请求其referer需要来自同一个网站，比如需要访问http://bank.example/withdraw?account=bob&amount=1000000&for=hack，用户需要先登陆到bank.example,然后通过页面的转账按钮来触发转账事件。这时，该请求的referer值就是按钮所在的那个页面的url。但是如果黑客要实施CSRF攻击的话，referer的值就会是Mr.Hack自己所搭建的那个网站的url，而一经银行的服务器验证是站外请求，就会直接拒绝，从而防御CSRF攻击。

### 在请求地址中添加token并验证
​ CSRF能够成功完全是因为黑客能够伪造用户的请求，在该请求中所有的用户验证信息都存在于cookie中，因此黑客才可以利用cookie来通过安全验证。要抵御CSRF，关键在于在请求中放入黑客不能伪造的信息，并且该信息不存在在cookie中。那么我们就可以在HTTP请求中以参数的形式加入一个随机生成的token，并在服务器端建立一个拦截器来验证这个token，如果请求中没有token或token的内容的不正确，则认为不安全从而直接拒绝该请求。(一般是服务器端生成的)

​ 具体内容可看下面这篇博客:CSRF攻击预防的Token生成以及验证原理 - 简书 (jianshu.com)

​ 使用token的一个难点就是如何把token以参数的形式加入请求。

### 在HTTP头中自定义属性并验证
​ 这里也是使用token并进行验证，和上一种方法不同的是，这里并不是把token以参数的形式置于HTTP请求中去，而是把它放到HTTP投中自定义的属性里。